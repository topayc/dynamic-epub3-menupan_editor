A3Maker=A3Maker||{},A3Maker.Component={};var comInx=1;A3Maker.Component.build=function(t,e,i){var o="";e=e||i.type;switch(e){case"image":o=new A3Maker.Component.ImageComponent(t,i);break;case"table":o=new A3Maker.Component.TableComponent(t,i);break;case"box":case"text":o=new A3Maker.Component.TextComponent(t,i);break;case"link":o=new A3Maker.Component.LinkComponent(t,i);break;case"order":o=new A3Maker.Component.OrderComponent(t,i);break;case"popup":o=new A3Maker.Component.PopupComponent(t,i);break;case"list":o=new A3Maker.Component.ListComponent(t,i);break;case"listrow":o=new A3Maker.Component.ListRowComponent(t,i);break;case"script":o=new A3Maker.Component.ScriptComponent(t,i);break;case"panseo":o=new A3Maker.Component.PanseoComponent(t,i);break;case"camera":o=new A3Maker.Component.CameraComponent(t,i)}return o},A3Maker.Component.Base=function(t){if(this.data=t,this.data){if(void 0!==this.data.childs&&delete this.data.childs,this.isValid=!1,this.validationErrorMessages=[],this.cornerActionTriggerRadius="listrow"==this.data.type?0:8,this.initComponent(this.data),this.buildDomOject(),A3Maker.project.componentMap[this.data.id]=this,"listrow"==this.data.type){var e=0;this.parent.childs.length<1?this.data.top=0:($.each(this.parent.childs,function(t,i){e+=i.data.height}),this.data.top=e)}if("defined"!=typeof this.parent){var i=this;i.resizingBorderStr=A3Maker.resizingBorderStr,i.componentBorderLine=A3Maker.componentBorderLine}}},A3Maker.Component.Base.prototype.selectEnum={common:0,drag_ctrl_select:1,Move:9},A3Maker.Component.Base.prototype.get=function(t){return this[t]},A3Maker.Component.Base.prototype.setData=function(t){for(var e in t)this.data[e]=t[e];this.refresh()},A3Maker.Component.Base.prototype.set=function(t,e){this[t]=e},A3Maker.Component.Base.prototype.initComponent=function(t){if(t){t.idCreate&&1==t.idCreate&&(t.id=t.UUID=t.wrapperId=A3Maker.util.genUUID(),t.no=this.parent.createComponentNo(t.type),t.name=this.name=t.type+t.no,delete t.idCreate),t.id||(t.id=A3Maker.util.genUUID(),t.UUID=t.id,t.wrapperId=t.id,t.no=this.parent.createComponentNo(t.type),t.name=t.type+t.no,this.name=t.name);this.ActionsEnum.None;this.isShown=!1,this.lastMouseX=0,this.lastMouseY=0,this.selectStatus=!1}},A3Maker.Component.Base.prototype.buildDomOject=function(){try{this.wrapperStr='<div  class ="moveActionTrigger eggbon_com" style="cursor : move;position:absolute" id="'+this.data.wrapperId+'"><div   class="internalWrapper"></div></div>',this.externalWrapperQueryStr="#"+this.data.wrapperId,this.internalWrapperQueryStr=this.externalWrapperQueryStr+" .internalWrapper",this.originalElementQueryStr=this.internalWrapperQueryStr+" .component",this.moveActionTriggerQueryStr=this.externalWrapperQueryStr,this.topActionTriggerQueryStr=this.externalWrapperQueryStr+" .topActionTrigger",this.bottomActionTriggerQueryStr=this.externalWrapperQueryStr+" .bottomActionTrigger",this.leftActionTriggerQueryStr=this.externalWrapperQueryStr+" .leftActionTrigger",this.rightActionTriggerQueryStr=this.externalWrapperQueryStr+" .rightActionTrigger",this.topLeftActionTriggerQueryStr=this.externalWrapperQueryStr+" .topLeftActionTrigger",this.topRightActionTriggerQueryStr=this.externalWrapperQueryStr+" .topRightActionTrigger",this.bottomLeftActionTriggerQueryStr=this.externalWrapperQueryStr+" .bottomLeftActionTrigger",this.bottomRightActionTriggerQueryStr=this.externalWrapperQueryStr+" .bottomRightActionTrigger",this.topMiddleActionTriggerQueryStr=this.externalWrapperQueryStr+" .topMiddleActionTrigger",this.leftMiddleActionTriggerQueryStr=this.externalWrapperQueryStr+" .leftMiddleActionTrigger",this.rightMiddleActionTriggerQueryStr=this.externalWrapperQueryStr+" .rightMiddleActionTrigger",this.bottomMiddleActionTriggerQueryStr=this.externalWrapperQueryStr+" .bottomMiddleActionTrigger",this.resizingGripStr=this.externalWrapperQueryStr+" .resizing_grip",this.componentBorder=this.externalWrapperQueryStr+" > .component_border",this.resizingGripStrDirectChild=this.externalWrapperQueryStr+"> .resizing_grip",this.resizingGropActionStr=this.externalWrapperQueryStr+" .resizing_grip_action",this.topDrawingQueryStr=this.externalWrapperQueryStr+" .topDrawing",this.bottomDrawingQueryStr=this.externalWrapperQueryStr+" .bottomDrawing",this.leftDrawingQueryStr=this.externalWrapperQueryStr+" .leftDrawing",this.rightDrawingQueryStr=this.externalWrapperQueryStr+" .rightDrawing",this.topLeftDrawingQueryStr=this.externalWrapperQueryStr+" .topLeftDrawing",this.topRightDrawingQueryStr=this.externalWrapperQueryStr+" .topRightDrawing",this.bottomLeftDrawingQueryStr=this.externalWrapperQueryStr+" .bottomLeftDrawing",this.bottomRightDrawingQueryStr=this.externalWrapperQueryStr+" .bottomRightDrawing",this.topMiddleDrawingQueryStr=this.externalWrapperQueryStr+" .topMiddleDrawing",this.leftMiddleDrawingQueryStr=this.externalWrapperQueryStr+" .leftMiddleDrawing",this.rightMiddleDrawingQueryStr=this.externalWrapperQueryStr+" .rightMiddleDrawing",this.bottomDrawingQueryStr=this.externalWrapperQueryStr+" .bottomDrawing",this.bottomMiddleDrawingQueryStr=this.externalWrapperQueryStr+" .bottomMiddleDrawing",this.textActionTriggerQueryStr=this.externalWrapperQueryStr+" .text_action_trigger",this.propertyContainerQueryStr="#property_container"}catch(t){console.log(t)}},A3Maker.Component.Base.prototype.generateExternalContainerId=function(){return"external_component_"+this.data.fullName},A3Maker.Component.Base.prototype.attach=function(){this.createOriginElementByType(this.data.type),this.parent instanceof A3Maker.Page?this.parent.$pageHolderSelector.append(this.originalElement):$(this.parent.originalElement).append(this.originalElement),this.createWrapperElement(),"listrow"==this.data.type?$(this.gripBottomLineStr).show():$(this.gripBottomLineStr).remove(),"panseo"==this.data.type&&(this.hideGripTool(),$(this.externalWrapperQueryStr).css("z-index",10001)),"popup"==this.data.type&&$(this.externalWrapperQueryStr).css("z-index",1e4)},A3Maker.Component.Base.prototype.detach=function(){$(this.externalWrapperQueryStr).remove(),A3Maker.propertyWindow.closePropertyWindow()},A3Maker.Component.Base.prototype.remove=function(){this.detach()},A3Maker.Component.Base.prototype.createWrapperElement=function(){this.addWrapperElements(),this.initializeEventHandlers(),this.adjustWrapper()},A3Maker.Component.Base.prototype.createOriginElementByType=function(t){var e=this.data.left,i=this.data.top,o=this.data.width,a=this.data.height;switch(t){case"image":this.originalElement=$("<img/>"),this.originalElement.attr("src",this.data["background-image"]),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.addClass("component"),this.originalElement.addClass(".tooltip_event"),this.originalElement.data("component","image"),this.originalElement.addClass("component-image"),this.originalElement.css("left",e+"px"),this.originalElement.css("top",i+"px"),this.originalElement.css("width",o+"px"),this.originalElement.css("height",a+"px"),this.originalElement.css("border-radius",this.data.radius+"%"),this.originalElement.css("position","absolute"),this.originalElement.css("object-fit","fill"),this.originalElement.css("opacity",this.data.opacity),this.originalElement.css("border-radius",this.data["border-radius"]+"%");break;case"text":this.originalElementStr=this.originalElement=$("<div></div>"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.css("left",e+"px"),this.originalElement.css("top",i+"px"),this.originalElement.css("width",o+"px"),this.originalElement.css("height",a+"px"),this.originalElement.css("position","absolute"),this.originalElement.css("overflow","hidden"),this.originalElement.css("text-overflow","hidden"),this.originalElement.css("opacity",this.data.opacity),this.originalElement.css("border-radius",this.data["border-radius"]+"%"),this.data["background-color"]&&this.originalElement.css("background-color",this.data["background-color"]);var n=$("<textarea></textarea>");n.data("component","text"),n.attr("placeholder","Insert Text"),n.addClass("component"),n.addClass("component-text"),n.addClass("text_input_area"),n.css("outline","none"),n.css("width","100%"),n.css("height","100%"),n.css("border-color","Transparent"),n.css("font-size",this.data["font-size"]),n.css("font-family",this.data["font-family"]),n.css("font-weight",this.data["font-weight"]),n.css("color",this.data.color),n.css("background-color","rgba(0,0,0,0)"),n.css("overflow","visible"),n.attr("border","none"),n.text(this.data.text),this.originalElement.append(n);break;case"link":this.originalElement=$("<img/>"),this.originalElement.data("component","link"),this.originalElement.addClass("component"),this.originalElement.addClass("component-link"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.attr("position",this.data.position),this.originalElement.attr("linktype",this.data.linkType),this.originalElement.attr("src",this.data["background-image"]),this.originalElement.css("left",e+"px"),this.originalElement.css("top",i+"px"),this.originalElement.css("width",o+"px"),this.originalElement.css("height",a+"px"),this.originalElement.css("position","absolute"),this.originalElement.css("opacity",this.data.opacity),this.originalElement.css("border-radius",this.data["border-radius"]+"%");break;case"order":this.originalElement=$("<img/>"),this.originalElement.attr("src",this.data["background-image"]),this.originalElement.data("component","order"),this.originalElement.addClass("component"),this.originalElement.addClass("component-order"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.attr("menuId",this.data.menuId),this.originalElement.attr("price",this.data.price),this.originalElement.attr("menu",this.data.menu),this.originalElement.css("left",e+"px"),this.originalElement.css("top",i+"px"),this.originalElement.css("width",o+"px"),this.originalElement.css("height",a+"px"),this.originalElement.css("position","absolute"),this.originalElement.attr("item_name",this.data.menuName),this.originalElement.attr("item_code",this.data.menuCode),this.originalElement.attr("item_price",this.data.menuPrice),this.originalElement.attr("store_code",A3Maker.dummy.storeCode),this.originalElement.attr("group_code",this.data.menuGroupCode),this.originalElement.attr("group_name",this.data.menyGroupName),this.originalElement.css("opacity",this.data.opacity),this.originalElement.css("border-radius",this.data["border-radius"]+"%");break;case"popup":this.data.width=this.data.width?this.data.width:o=A3Maker.project.width-2*this.data.left,this.data.height=this.data.height?this.data.height:a=A3Maker.project.width-2*this.data.top;this.data["backgrouund-color"]&&this.data["background-color"],this.data["background-image"]&&this.data["background-image"];this.originalElement=$("<div></div>"),this.originalElement.data("component","popup"),this.originalElement.addClass("component"),this.originalElement.addClass("component-popup"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.css("left",e+"px"),this.originalElement.css("top",i+"px"),this.originalElement.css("width",o+"px"),this.originalElement.css("height",a+"px"),this.originalElement.css("position","absolute"),this.originalElement.css("overflow","hidden"),this.originalElement.css("text-overflow","hidden"),this.originalElement.css("background-color",this.data.backgroundColor?this.data.backgroundColor:"#FFFFFF"),this.originalElement.css("background-color",this.data["background-color"]?this.data["background-color"]:"#FFFFFF"),this.data["background-image"]&&(this.originalElement.css("background-size","100% 100%"),this.originalElement.css("background-image",this.data["background-image"]),this.originalElement.css("background-image","url("+this.data["background-image"]+")")),this.originalElement.css("opacity",this.data.opacity),this.originalElement.css("border-radius",this.data["border-radius"]+"%");break;case"list":this.originalElement=$("<div></div>"),this.originalElement.data("component","list"),this.originalElement.addClass("component"),this.originalElement.addClass("component-list"),this.originalElement.addClass("transparent_scroll"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.css("left",e+"px"),this.originalElement.css("top",i+"px"),this.originalElement.css("width",o+"px"),this.originalElement.css("height",a+"px"),this.originalElement.css("position","absolute"),this.originalElement.css("overflow-y","auto"),this.originalElement.css("overflow-x","hidden"),this.originalElement.css("background-color",this.data.backGroundColor?this.data.backGroundColor:"#FFFFFF"),this.originalElement.css("background-color",this.data["background-color"]?this.data["background-color"]:"#FFFFFF"),this.data["background-color"]&&this.originalElement.css("background-color",this.data["background-color"]),this.data["background-image"]&&(this.originalElement.css("background-size","100% 100%"),this.originalElement.css("background-image",this.data["background-image"]),this.originalElement.css("background-image","url("+this.data["background-image"]+")")),this.data.opacity&&this.originalElement.css("opacity",this.data.opacity);break;case"listrow":this.data.width=this.parent.data.width,this.originalElement=$("<div></div>"),this.originalElement.data("component","listrow"),this.originalElement.addClass("component"),this.originalElement.addClass("component-listrow"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.css("width",this.parent.data.width-10+"px"),this.originalElement.css("height",this.data.height+"px"),this.originalElement.css("position","relative"),this.originalElement.css("left",e+"px"),this.originalElement.css("top",i+"px"),this.originalElement.css("overflow-x","hidden"),this.originalElement.css("overflow-y","auto"),this.data["background-color"]&&this.originalElement.css("background-color",this.data["background-color"]),this.data["background-image"]&&(this.originalElement.css("background-size","100% 100%"),this.originalElement.css("background-image",this.data["background-image"]),this.originalElement.css("background-image","url("+this.data["background-image"]+")")),this.data.opacity&&this.originalElement.css("opacity",this.data.opacity);break;case"panseo":this.originalElement=$("<canvas></canvas>"),this.originalElement.data("component","panseo"),this.originalElement.addClass("component"),this.originalElement.addClass("component-panseo"),this.originalElement.addClass("transparent_scroll"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.css("left",e+"px"),this.originalElement.css("top",i+"px"),this.originalElement.attr("id",this.data.canvasID?this.data.canvasID:A3Maker.util.generateRandomString(20)),this.originalElement.attr("width",o),this.originalElement.attr("height",o),this.originalElement.css("width",o+"px"),this.originalElement.css("height",a+"px"),this.originalElement.css("position","absolute"),this.originalElement.css("overflow-y","auto"),this.originalElement.css("overflow-x","hidden"),this.originalElement.css("cursor","default");var r=this.data["background-color"]?this.data["background-color"]:"#FFFFFF";this.originalElement.css("background-color",r),this.data["background-image"]&&(this.originalElement.css("background-size","100% 100%"),this.originalElement.css("background-image",this.data["background-image"]),this.originalElement.css("background-image","url("+this.data["background-image"]+")")),this.originalElement.css("opacity",this.data.opacity),this.originalElement.css("border-radius",this.data["border-radius"]+"%");break;case"camera":this.originalElement=$("<div></div>"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.css("left",e+"px"),this.originalElement.css("top",i+"px"),this.originalElement.css("width",o+"px"),this.originalElement.css("height",a+"px"),this.originalElement.css("position","absolute"),this.originalElement.css("text-overflow","hidden"),this.originalElement.css("opacity",this.data.opacity),this.originalElement.css("border-radius",this.data["border-radius"]+"%"),this.originalElement.css("background-color",this.data["background-color"]),this.originalElement.css("object-fit","cover"),this.originalElement.css("cursor","move");var s=$("<video></video>");s.data("component","camera"),s.addClass("component"),s.addClass("component-camera"),s.addClass("transparent_scroll"),s.addClass(".tooltip_event"),s.attr("title",t.toUpperCase()+" Component"),s.attr("poster",this.data.poster),s.attr("id",this.data.videoID?this.data.videoID:A3Maker.util.generateRandomString(20)),s.attr("width","100%"),s.attr("height","100%"),s.css("width","100%"),s.css("height","100%"),s.css("position","relative"),s.css("object-fit","contain"),s.css("overflow-y","auto"),s.css("overflow-x","hidden");r=this.data["background-color"]?this.data["background-color"]:"#FFFFFF";s.css("background-color",r),this.data["background-image"]&&(s.css("background-size","100% 100%"),s.css("background-image",this.data["background-image"]),s.css("background-image","url("+this.data["background-image"]+")")),s.css("opacity",this.data.opacity),s.css("border-radius",this.data["border-radius"]+"%");var l=$("<div></div>").addClass("recording-indicator").css("position","absolute").css("top","14px").css("left","8px").css("width","16px").css("height","16px").css("border-radius","50%").css("background-color","red").css("display","none").css("z-index",1).css("align-items","center").css("animation","blink 1s infinite"),h=$("<span></span>").addClass("recording-time").css("position","absolute").css("top","10px").css("left","29px").css("width","70px").css("height","20px").css("display","none").css("background-color","red").css("color","#FFFFFF").css("border-radius","10px").css("font-size","13px").css("padding","2px 11px 2px 11px").css("text-align","center").css("color","#ffffff").css("font-weight","bold").text("00:00:00"),p=$("<span></span>").addClass("pause-indigator").css("position","absolute").css("top","8px").css("left","13px").css("width","55px").css("display","none").css("background-color","#FF0000").css("color","#FFFFFF").css("border-radius","10px").css("font-size","12px").css("padding","3px 11px 3px 11px").css("text-align","center").css("color","#ffffff").css("font-weight","bold").css("animation","blink 1s infinite").text("PAUSE");this.originalElement.append(s),this.originalElement.append(l),this.originalElement.append(h),this.originalElement.append(p);break;case"script":this.originalElement=$("<img/>"),this.originalElement.attr("src",this.data["background-image"]),this.originalElement.data("component","script"),this.originalElement.addClass("component"),this.originalElement.addClass("component-script"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.css("width","100%"),this.originalElement.css("height",this.data.height+"px"),this.originalElement.css("position","absolute");break;case"table":this.data.width=o=A3Maker.project.width-2*this.data.left;this.data.height,this.data.rowCnt,this.data.width,this.data.colCnt;var c=this.data.border+"px "+this.data["border-style"]+" "+this.data["border-color"],d="";this.originalElement=$("<table></table>"),this.originalElement.data("component","tablet"),this.originalElement.addClass("component"),this.originalElement.addClass("component-table"),this.originalElement.addClass(".tooltip_event"),this.originalElement.attr("title",t.toUpperCase()+" Component"),this.originalElement.css("width","100%"),this.originalElement.css("height","100%"),this.originalElement.css("position","absolute"),this.originalElement.css("border-collapse","collapse"),this.originalElement.css("border",c),this.originalElement.css("border-spacing",this.data.cellspacing),this.originalElement.css("overflow","hidden"),this.originalElement.css("text-overflow","hidden"),this.originalElement.css("background-color","#FFFFFF"),this.data.opacity&&this.originalElement.css("opacity",this.data.opacity);for(var m=0;m<this.data.rowCnt;m++){var g=m+1;d+='<tr com_row ="'+g+'" >';for(var u=0;u<this.data.colCnt;u++){var f=u+1;d+='<td  com_row = "'+g+'" com_col = "'+f+'" style ="text-align:left;vertical-align:center;padding:'+this.data.cellpadding+'px;"></td>'}d+="</tr>"}d+="</tbody>";$(d);this.originalElement.append(d),this.originalElement.css("border",c),this.originalElement.find("tr").css("border",c),this.originalElement.find("td").css("border",c),this.originalElement.find("tr").css("width","100%"),this.originalElement.find("td").css("color",this.data.color),this.originalElement.find("td").css("font-size",this.data["font-size"]),this.originalElement.find("td").css("font-family",this.data["font-family"]),this.originalElement.find("td").html('<div style ="line-height:30px;margin:3px;margin-left:10px;width:100%;height:100%" contenteditable="true"></div>'),this.originalElement.find("td > div").css("font-size",this.data["font-size"]),this.originalElement.find("td > div").css("font-family",this.data["font-family"]),this.originalElement.css("background-color",this.data["background-color"]),this.originalElement.css("opacity",this.data.opacity),this.originalElement.css("filter","alpha(opacity = "+this.data.opacity+")"),this.originalElement.css("-ms-filter","alpha(opacity="+this.data.opacity+")")}},A3Maker.Component.Base.prototype.addWrapperElements=function(){if(this.data.type){$(this.originalElement).wrap(this.wrapperStr);$(this.internalWrapperQueryStr).after(this.resizingBorderStr);$(this.internalWrapperQueryStr).after(this.componentBorderLine);var t=this.data.left+"px",e=this.data.top+"px";"listrow"==this.data.type&&($(this.externalWrapperQueryStr).css("position","relative"),e=12*this.parent.childs.length+"px"),$(this.externalWrapperQueryStr).css("left",t),$(this.externalWrapperQueryStr).css("top",e),$(this.originalElement).css("left",0),$(this.originalElement).css("top",0)}},A3Maker.Component.Base.prototype.adjustWrapper=function(){var t=this.data.width,e=this.data.height;this.cornerActionTriggerRadius,this.cornerActionTriggerRadius;$(this.internalWrapperQueryStr).width(t+"px"),$(this.internalWrapperQueryStr).height(e+"px"),$(this.externalWrapperQueryStr).width(t+"px"),$(this.externalWrapperQueryStr).height(e+"px")},A3Maker.Component.Base.prototype.calcValueByZoom=function(t,e){return"left"==t||"width"==t?e*A3Maker.controller.canvasWidth/A3Maker.project.width:"top"==t||"height"==t?e*A3Maker.controller.canvasHeight/A3Maker.project.height:void 0},A3Maker.Component.Base.prototype.displayComponentInfo=function(t){if(1==this.selectStatus){var e="x : "+this.data.left+" ,  ";e+="y : "+this.data.top+"  ,  ",e+="width: "+this.data.width+"  , ",e+="height : "+this.data.height+"   ",$("#position").text(e)}},A3Maker.Component.Base.prototype.enablePropertyWindow=function(t){t?(A3Maker.propertyWindow.setInitInfo({name:this.data.name,x:this.data.left,y:this.data.top,width:this.data.width,height:this.data.height,fixRatio:this.data.fixRatio}),A3Maker.propertyWindow.showPropertyWindow(this.data.type)):A3Maker.propertyWindow.closePropertyWindow()},A3Maker.Component.Base.prototype.isContainer=function(){var t={isContainer:!1,type:this.data.type};return"list"!=this.data.type&&"listrow"!=this.data.type&&"popup"!=this.data.type||(t.isContainer=!0),t},A3Maker.Component.Base.prototype.destroy=function(t){this.selectStatus=!1,this.detach(),A3Maker.setSelectedComponent(null)},A3Maker.Component.Base.prototype.setSelectStatus=function(t,e){if(1==t){A3Maker.controller.resetEditor();var i=[];$.each(i,function(t,e){o=A3Maker.controller.$tree.tree("getNodeById",e.data.UUID),A3Maker.controller.$tree.tree("openNode",o)}),A3Maker.findParentsRecursive(i,this),A3Maker.controller.enableBeforeGrayPanel(!1,null),A3Maker.controller.applyToolButtonChange(this);var o=A3Maker.controller.$tree.tree("getNodeById",this.data.UUID);A3Maker.controller.$tree.tree("selectNode",o),A3Maker.setSelectedComponent(this),this.enablePropertyWindow(!0),this.showBorderTool(),this.showGripTool(),"panseo"==this.data.type&&this.hideGripTool(),1==i.length&&"page"==i[0].data.type&&("popup"==this.data.type&&A3Maker.controller.enableBeforeGrayPanel(!0,this),$(this.externalWrapperQueryStr).show()),i.length>1&&("popup"==i[1].data.type&&A3Maker.controller.enableBeforeGrayPanel(!0,i[1]),$(i[1].externalWrapperQueryStr).show())}else $(".attributes_center span.top_x_pos").html(""),$(".attributes_center span.top_y_pos").html(""),this.enablePropertyWindow(!1),this.hideBorderTool(),this.hideGripTool(),this.currentAction=this.ActionsEnum.None,A3Maker.controller.$tree.tree("selectNode",null);this.selectStatus=t},A3Maker.Component.Base.prototype.hideBorderTool=function(){$(this.componentBorder).hide()},A3Maker.Component.Base.prototype.showBorderTool=function(){$(this.componentBorder).removeClass("component_border_multi_select").addClass("component_border_common").show()},A3Maker.Component.Base.prototype.showBorderSelect=function(){$(this.componentBorder).removeClass("component_border_common").addClass("component_border_multi_select").show()},A3Maker.Component.Base.prototype.hideBorderSelect=function(){$(this.componentBorder).removeClass("component_border_multi_select").addClass("component_border_common").hide()},A3Maker.Component.Base.prototype.show=function(){$(this.moveActionTriggerQueryStr).hide()},A3Maker.Component.Base.prototype.hide=function(){$(this.moveActionTriggerQueryStr).show()},A3Maker.Component.Base.prototype.hideGripTool=function(){$(this.resizingGripStr).hide(),"listrow"==this.data.type&&$(this.gripBottomLineStr).hide()},A3Maker.Component.Base.prototype.showGripTool=function(){"popup"==this.data.type||"listrow"==this.data.type||"list"==this.data.type?$(this.resizingGripStrDirectChild).show():$(this.resizingGripStr).show(),"listrow"==this.data.type&&(this.hideGripTool(),$(this.gripBottomLineStr).show())},A3Maker.Component.Base.prototype.createComponent=function(t,e,i,o){if(!this instanceof A3Maker.Component.ListComponent&&!this instanceof A3Maker.Component.PopupComponent&&!this instanceof A3Maker.Component.ListRowComponent)throw"invalid container";e=void 0===e||e,i=void 0===i||i;var a=this.checkPermittable(t);if(!a)throw"can`t a component in this container ["+this.data.type+"]";var n=A3Maker.Component.build(this,t,o);return e&&this.addComponent(n),i&&this.addComponentToTree(n),n},A3Maker.Component.Base.prototype.removeComponent=function(t){if(!this instanceof A3Maker.Component.ListComponent&&!this instanceof A3Maker.Component.PopupComponent&&!this instanceof A3Maker.Component.ListRowComponent)throw"invalid container";var e=-1;$.each(this.childs,function(i,o){t.getProperty("UUID")!=o.getProperty("UUID")||(e=i)}),-1!=e&&this.childs.splice(e,1),this.removeCompoentToTree(t),t.selectStatus=!1,t.detach()},A3Maker.Component.Base.prototype.removeCompoentToTree=function(t){var e=A3Maker.controller.$tree.tree("getNodeById",t.data.UUID);A3Maker.controller.$tree.tree("removeNode",e)},A3Maker.Component.Base.prototype.addComponent=function(t){if(!this instanceof A3Maker.Component.ListComponent&&!this instanceof A3Maker.Component.PopupComponent&&!this instanceof A3Maker.Component.ListRowComponent)return!1;this.childs.push(t)},A3Maker.Component.Base.prototype.addComponentToTree=function(t){var e=A3Maker.controller.$tree.tree("getNodeById",t.parent.data.UUID);A3Maker.controller.$tree.tree("appendNode",{label:t.data.name,id:t.data.UUID,type:t.data.type,data:t},e)},A3Maker.Component.Base.prototype.checkPermittable=function(t){var e=A3Maker.componentType[this.data.type].permittableChildComps;return e.includes(t)},A3Maker.Component.Base.prototype.createComponentNo=function(t){var e=0,i=$.map(this.childs,function(e){return e.type==t?e:null});if(Array.isArray(i))return e=0==i.length?1:i[i.length-1].no+1,e},A3Maker.Component.Base.prototype.extract=function(t){var e=this;$.each(t,function(t,i){e.setProperty(t,i)})},A3Maker.Component.Base.prototype.getProperty=function(t){return!!this.hasOwnProperty(t)&&this[t]},A3Maker.Component.Base.prototype.setProperty=function(t,e){this[t]=e},A3Maker.Component.Base.prototype.genUUID=function(){var t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:7&i|8).toString(16)});return e},A3Maker.Component.Base.prototype.ActionsEnum={None:0,LeftResize:1,TopResize:2,RightResize:3,BottomResize:4,TopLeftResize:5,BottomLeftResize:6,TopRightResize:7,BottomRightResize:8,Move:9},A3Maker.Component.Base.prototype.cornerActionTriggerRadius=8,A3Maker.Component.Base.prototype.showWrapper=function(){this.addWrapperElements(),this.initializeEventHandlers(),this.data.type,"listrow"==this.data.type&&$(this.moveActionTriggerQueryStr).remove()},A3Maker.Component.Base.prototype.hideWrapper=function(){var t=parseInt($(this.externalWrapperQueryStr).css("left")),e=parseInt($(this.externalWrapperQueryStr).css("top")),i=t+this.cornerActionTriggerRadius+"px",o=e+this.cornerActionTriggerRadius+"px";$(this.originalElement).css("left",i),$(this.originalElement).css("top",o),$(this.originalElement).css("position",$(this.externalWrapperQueryStr).css("position")),$(this.externalWrapperQueryStr).replaceWith(this.originalElement)},A3Maker.Component.Base.prototype.initializeEventHandlers=function(){var t=this;"listrow"==this.data.type?$(this.gripBottomLineStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.BottomResize,A3Maker.project.isComponentAction=!0}):($(this.topMiddleActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.stopPropagation(),e.preventDefault(),t.currentAction=t.ActionsEnum.TopResize,A3Maker.project.isComponentAction=!0}),$(this.leftMiddleActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.stopPropagation(),e.preventDefault(),t.currentAction=t.ActionsEnum.LeftResize,A3Maker.project.isComponentAction=!0}),$(this.rightMiddleActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.RightResize,A3Maker.project.isComponentAction=!0}),$(this.bottomMiddleActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.BottomResize,A3Maker.project.isComponentAction=!0}),"table"==this.data.type&&($(this.bottomActionTriggerQueryStr).css("cursor","move"),$(this.topActionTriggerQueryStr).css("cursor","move"),$(this.leftActionTriggerQueryStr).css("cursor","move"),$(this.rightActionTriggerQueryStr).css("cursor","move")),$(this.bottomActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.BottomResize,"table"==t.data.type&&(t.currentAction=t.ActionsEnum.Move),A3Maker.project.isComponentAction=!0}),$(this.topActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.TopResize,"table"==t.data.type&&(t.currentAction=t.ActionsEnum.Move),A3Maker.project.isComponentAction=!0}),$(this.leftActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.LeftResize,"table"==t.data.type&&(t.currentAction=t.ActionsEnum.Move),A3Maker.project.isComponentAction=!0}),
$(this.rightActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.RightResize,"table"==t.data.type&&(t.currentAction=t.ActionsEnum.Move),A3Maker.project.isComponentAction=!0}),$(this.gripBottomLineStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.BottomResize,A3Maker.project.isComponentAction=!0}),$(this.topLeftActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.TopLeftResize,A3Maker.project.isComponentAction=!0}),$(this.topRightActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),t.currentAction=t.ActionsEnum.TopRightResize,A3Maker.project.isComponentAction=!0}),$(this.bottomLeftActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),A3Maker.project.isComponentAction=!0,t.currentAction=t.ActionsEnum.BottomLeftResize}),$(this.bottomRightActionTriggerQueryStr).mousedown(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),A3Maker.project.isComponentAction=!0,t.currentAction=t.ActionsEnum.BottomRightResize}),$(this.moveActionTriggerQueryStr).dblclick(function(e){A3Maker.multiSelectionRect.resetSelection(),e.preventDefault(),e.stopPropagation(),"text"==t.data.type&&($(t.textInputAreaQueryStr).select(),$(t.textInputAreaQueryStr).focus()),"script"==t.data.type&&A3Maker.codeWindow.open("JS/HTML",t)}),"text"==this.data.type&&$(t.textInputAreaQueryStr).focusout(function(){event.preventDefault(),t.data.text=$(this).val()})),"table"==this.data.type?(this.originalElement.hover(function(){t.originalElement.find("td").resizable(),t.originalElement.find("td").resizable("enable"),t.showBorderTool()},function(){t.originalElement.find("td").resizable(),t.originalElement.find("td").resizable("disable"),0==t.selectStatus&&t.hideBorderTool()}),this.originalElement.css("cursor","text"),this.originalElement.find("td").click(function(){0==t.selectStatus&&t.setSelectStatus(!0),event.stopPropagation(),event.preventDefault()})):($(this.moveActionTriggerQueryStr).mousedown(function(e){if(A3Maker.propertyWindow.isUploading)alert("now is uploading..please wait");else if(e.ctrlKey){if(e.stopPropagation(),e.preventDefault(),"popup"==t.data.type||"listrow"==t.data.type)return void t.setSelectStatus(!1);if(A3Maker.multiSelectionRect.isComponentContained(t))A3Maker.multiSelectionRect.removeComponentToSelection(t);else{if(A3Maker.multiSelectionRect.getMultiSelectedComponentCount()<1){var i=A3Maker.getSelectedComponent();i&&i.setSelectStatus(!1)}A3Maker.multiSelectionRect.addComponentToSelection(t)}}else e.stopPropagation(),e.preventDefault(),A3Maker.multiSelectionRect.isComponentContained(t)||(A3Maker.contextMenu.close(),A3Maker.multiSelectionRect.resetSelection(),t.setSelectStatus(!0),A3Maker.project.isComponentAction=!0),(t.type="table")&&t.originalElement.find(".component-table-hover").removeClass("component-table-hover"),t.currentAction=t.ActionsEnum.Move}),$(this.moveActionTriggerQueryStr).mouseover(function(e){e.preventDefault(),e.stopPropagation(),e.ctrlKey||A3Maker.multiSelectionRect.isMultiSelected()||A3Maker.multiSelectionRect.isComponentContained(t)||A3Maker.multiSelectionRect.curSelectionAction==A3Maker.multiSelectionRect.selectionActionEnum.drag||0==A3Maker.project.isComponentAction&&0==t.selectStatus&&t.showBorderTool()}),$(this.moveActionTriggerQueryStr).mouseout(function(e){e.preventDefault(),e.stopPropagation(),A3Maker.multiSelectionRect.isComponentContained(t)||0==A3Maker.project.isComponentAction&&0==t.selectStatus&&t.hideBorderTool()})),$(A3Maker.editorPane).mousemove(function(e){e.ctrlKey||t.onMouseMove(e)}),$(A3Maker.editorPane).mouseup(function(e){A3Maker.project.isComponentAction=!1,t.currentAction=t.ActionsEnum.None})},A3Maker.Component.Base.prototype.onMouseMove=function(t){var e=t.clientX,i=t.clientY,o=e-this.lastMouseX,a=i-this.lastMouseY;Math.abs(o)<A3Maker.controller.snapValue&&Math.abs(a)<A3Maker.controller.snapValue||(this.applyMouseMoveAction(o,a),this.lastMouseX=t.clientX,this.lastMouseY=t.clientY)},A3Maker.Component.Base.prototype.applyMouseMoveAction=function(t,e){var i=0,o=0,a=0,n=0;if(void 0!==this.currentAction&&this.currentAction!=this.ActionsEnum.RightResize.None)if(this.currentAction!=this.ActionsEnum.RightResize&&this.currentAction!=this.ActionsEnum.TopRightResize&&this.currentAction!=this.ActionsEnum.BottomRightResize||(a=t,A3Maker.propertyWindow.isPositionFixed||this.enablePropertyWindow(!1)),this.currentAction!=this.ActionsEnum.LeftResize&&this.currentAction!=this.ActionsEnum.TopLeftResize&&this.currentAction!=this.ActionsEnum.BottomLeftResize||(a=-t,o=t,A3Maker.propertyWindow.isPositionFixed||this.enablePropertyWindow(!1)),this.currentAction!=this.ActionsEnum.BottomResize&&this.currentAction!=this.ActionsEnum.BottomLeftResize&&this.currentAction!=this.ActionsEnum.BottomRightResize||(n=e,A3Maker.propertyWindow.isPositionFixed||this.enablePropertyWindow(!1)),this.currentAction!=this.ActionsEnum.TopResize&&this.currentAction!=this.ActionsEnum.TopLeftResize&&this.currentAction!=this.ActionsEnum.TopRightResize||(n=-e,i=e,A3Maker.propertyWindow.isPositionFixed||this.enablePropertyWindow(!1)),this.currentAction==this.ActionsEnum.Move&&(o=t,i=e,A3Maker.propertyWindow.isPositionFixed||this.enablePropertyWindow(!1)),A3Maker.multiSelectionRect.isComponentSelected())$.each(A3Maker.multiSelectionRect.selectionComponentArr,function(t,e){e.updatePosition(o,i),e.updateSize(a,n),e.adjustWrapper(),e.updateComponentInfo(o,i,a,n)});else{if("listrow"==this.data.type&&(this.currentAction,this.ActionsEnum.BottomResize),this.selectStatus&&this.currentAction==this.ActionsEnum.Move){var r=A3Maker.project.getSelectedPage().childs;if(r.length>0){for(var s=[],l=$(A3Maker.holder).width(),h=$(A3Maker.holder).height(),p=0;p<r.length;p++){var c=r[p];if(this!=c){if(this.data.top==c.data.top||this.data.top==c.data.top+c.data.height){s.push([0,this.data.top,l,this.data.top]);break}if(this.data.top+this.data.height==c.data.top||this.data.top+this.data.height==c.data.top+c.data.height){s.push([0,this.data.top+this.data.height,l,this.data.top+this.data.height]);break}}}for(p=0;p<r.length;p++){c=r[p];if(this!=c){if(this.data.left==c.data.left||this.data.left==c.data.left+c.data.width){s.push([this.data.left,0,this.data.left,h]);break}if(this.data.left+this.data.width==c.data.left||this.data.left+this.data.width==c.data.left+c.data.width){s.push([this.data.left+this.data.width,0,this.data.left+this.data.width,h]);break}}}setTimeout(function(){A3Maker.draw.drawLines(s),s.lenght=0,s=null},10)}}"listrow"==this.data.type&&this.currentAction==this.ActionsEnum.BottomResize&&this.updatePositionNextRows(a,n),this.selectStatus&&(A3Maker.propertyWindow.setPosition(this.data.left,this.data.top,this.data.width,this.data.height),A3Maker.propertyWindow.movePropertyWindow($(this.originalElement).offset().left+this.data.width+10,$(this.originalElement).offset().top)),this.updatePosition(o,i),this.updateSize(a,n),this.updateComponentInfo(o,i,a,n),this.adjustWrapper()}},A3Maker.Component.Base.prototype.getAdjustValueByZoom=function(t){var e=A3Maker.canvas.zoom;if(100==e)return t;var i=0;return i=e<100?parseInt(t/(A3Maker.canvas.zoom/100)):parseInt(100*t/A3Maker.canvas.zoom),i},A3Maker.Component.Base.prototype.updatePosition=function(t,e){var i=this;"listrow"==this.data.type&&(i=this.parent);var o=parseInt($(i.externalWrapperQueryStr).css("left")),a=parseInt($(i.externalWrapperQueryStr).css("top")),n=0,r=0;n=o+i.getAdjustValueByZoom(t),r=a+i.getAdjustValueByZoom(e);$(i.externalWrapperQueryStr).css("left",n+"px"),$(i.externalWrapperQueryStr).css("top",r+"px")},A3Maker.Component.Base.prototype.updateSize=function(t,e){if(!(this.currentAction<1||this.currentAction>8)){var i=parseInt($(this.originalElement).width()),o=parseInt($(this.originalElement).height()),a=i+this.getAdjustValueByZoom(t),n=o+this.getAdjustValueByZoom(e),r=this.getAdjustValueByZoom(t),s=this.getAdjustValueByZoom(e),l=$(this.originalElement).get(0).naturalWidth,h=$(this.originalElement).get(0).naturalHeight;1==this.fixRatio?(a=i+r,n=o+this.getAdjustValueByZoom(parseInt(h*t/l))):(a=i+r,n=o+s);var p=1;a<p&&(a=p),n<p&&(n=p),$(this.originalElement).css("width",a+"px"),$(this.originalElement).css("height",n+"px")}},A3Maker.Component.Base.prototype.updateComponentInfo=function(t,e,i,o){var a=this;"listrow"==this.data.type?(this.data.width=this.data.width+this.getAdjustValueByZoom(i),this.data.height=this.data.height+this.getAdjustValueByZoom(o),this.parent.data.left=this.parent.data.left+this.parent.getAdjustValueByZoom(t),this.parent.data.top=this.parent.data.top+this.parent.getAdjustValueByZoom(e)):(this.data.left=this.data.left+this.getAdjustValueByZoom(t),this.data.top=this.data.top+this.getAdjustValueByZoom(e),this.data.width=this.data.width+this.getAdjustValueByZoom(i),this.data.height=this.data.height+this.getAdjustValueByZoom(o));var n=2*this.cornerActionTriggerRadius;this.data.width<n&&(this.data.width=n),this.data.height<n&&(this.data.height=n),this.selectStatus&&(A3Maker.propertyWindow.setPosition(this.data.left,this.data.top,this.data.width,this.data.height),A3Maker.propertyWindow.movePropertyWindow($(this.originalElement).offset().left+this.data.width+10,$(this.originalElement).offset().top)),"list"!=this.data.type||this.currentAction!=this.ActionsEnum.LeftResize&&this.currentAction!=this.ActionsEnum.RightResize||$.each(this.childs,function(t,e){e.data.width=a.data.width,$(e.wrapperStr).css("width",a.data.width),$(e.originalElementStr).css("width",a.data.width)})},A3Maker.Component.Base.prototype.updatePositionNextRows=function(t,e){if(!(this.parent.childs.length<2)){var i=-1,o=this;$.each(this.parent.childs,function(t,e){e.data.UUID!=o.data.UUID||(i=t)}),-1!=i&&$.each(this.parent.childs,function(t,o){t>=i&&(o.data.top=o.data.top+e)})}},A3Maker.Component.Base.prototype.updatePositionAndWidth=function(t,e,i,o){var a=-(this.data.left-t),n=-(this.data.top-e),r=-(this.data.width-i),s=-(this.data.height-o),l=parseInt($(this.externalWrapperQueryStr).css("left")),h=parseInt($(this.externalWrapperQueryStr).css("top")),p=l+a,c=h+n;$(this.externalWrapperQueryStr).css("left",p+"px"),$(this.externalWrapperQueryStr).css("top",c+"px");var d=parseInt($(this.originalElement).width()),m=parseInt($(this.originalElement).height()),g=d+r,u=m+s,f=2*this.cornerActionTriggerRadius;g<f&&(g=f),u<f&&(u=f),$(this.originalElement).css("width",g+"px"),$(this.originalElement).css("height",u+"px"),setTimeout(()=>this.adjustWrapper(),5),this.data.left=t,this.data.top=e,this.data.width=i,this.data.height=o;var A=2*this.cornerActionTriggerRadius;if(this.data.width<A&&(this.data.width=A),this.data.height<A&&(this.data.height=A),this.selectStatus,"list"==this.data.type){var k=this;$.each(this.childs,function(t,e){e.width=k.data.width,$(e.wrapperStr).css("width",k.data.width),$(e.originalElementStr).css("width",k.data.width)})}},A3Maker.Component.Base.prototype.setPositionAndWidth=function(t,e,i,o){i>A3Maker.project.width&&(i=A3Maker.project.width),o>A3Maker.project.height&&(o=A3Maker.project.height);var a=-(this.data.left-t),n=-(this.data.top-e),r=-(this.data.width-i),s=-(this.data.height-o),l=parseInt($(this.externalWrapperQueryStr).css("left")),h=parseInt($(this.externalWrapperQueryStr).css("top")),p=l+a,c=h+n;$(this.externalWrapperQueryStr).css("left",p+"px"),$(this.externalWrapperQueryStr).css("top",c+"px");var d=parseInt($(this.originalElement).width()),m=parseInt($(this.originalElement).height()),g=d+r,u=m+s,f=2*this.cornerActionTriggerRadius;g<f&&(g=f),u<f&&(u=f),$(this.originalElement).css("width",g+"px"),$(this.originalElement).css("height",u+"px"),setTimeout(()=>this.adjustWrapper(),5),this.data.left=t,this.data.top=e,this.data.width=i,this.data.height=o;var A=2*this.cornerActionTriggerRadius;if(this.data.width<A&&(this.data.width=A),this.data.height<A&&(this.data.height=A),this.selectStatus&&($(".attributes_center span.top_x_pos").html(this.data.left),$(".attributes_center span.top_y_pos").html(this.data.top),A3Maker.propertyWindow.setPosition(this.data.left,this.data.top,this.data.width,this.data.height),A3Maker.propertyWindow.movePropertyWindow($(this.originalElement).offset().left+this.data.width+10,$(this.originalElement).offset().top)),"list"==this.data.type){var k=this;$.each(this.childs,function(t,e){e.width=k.data.width,$(e.wrapperStr).css("width",k.data.width),$(e.originalElementStr).css("width",k.data.width)})}},A3Maker.Component.Base.prototype.setRadius=function(t){this.data.radius=t,$(this.originalElement).css("border-radius",t+"%")},A3Maker.Component.Base.prototype.setBorder=function(t){this.border=t,this.updateSize(2*t,2*t),$(this.originalElement).css("border",t+"px solid #888")},A3Maker.Component.Base.prototype.setImage=function(t){this.src=t,$(this.originalElement).attr("src",this.src)},A3Maker.Component.Base.prototype.resetImage=function(){this.data["background-image"]=this.defaultsrc,$(this.originalElement).attr("src",this.data["background-image"])},A3Maker.Component.ImageComponent=function(t,e){this.defaultsrc="images/img_image.png",this.name="";var i={wrapperId:"",no:0,UUID:"",name:"",left:10,top:10,type:"image",opacity:1,"border-radius":0,width:60,height:60,fixRatio:!1,"background-image":this.defaultsrc};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,A3Maker.Component.Base.call(this,i)},A3Maker.Component.ImageComponent.prototype.refresh=function(t){$(this.originalElement).css("width","100%"),$(this.originalElement).css("height","100%"),$(this.originalElement).css("background-size","cover"),$(this.originalElement).css("opacity",this.data.opacity),$(this.originalElement).css("border-radius",this.data["border-radius"]+"%"),""==this.data["background-image"]&&(this.data["background-image"]=this.defaultsrc),$(this.originalElement).attr("src",this.data["background-image"])},A3Maker.Component.TextComponent=function(t,e){this.name="";var i={UUID:"",wrapperId:"",no:0,name:"",left:10,top:10,width:250,height:80,type:"text",opacity:1,"border-radius":0,fixRatio:!1,placeHolder:"Insert Text",text:"","font-family":"Open Sans","font-size":"30pt","font-weight":100,color:"#FF862D","background-color":"rgba(255,255,255,0)","background-image":""};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,A3Maker.Component.Base.call(this,i),this.textInputAreaQueryStr=this.externalWrapperQueryStr+" .text_input_area"},A3Maker.Component.TextComponent.prototype.refresh=function(t){$(this.originalElement).css("opacity",this.data.opacity),$(this.originalElement).css("border-radius",this.data["border-radius"]+"%"),$(this.originalElement).css("background-color",this.data["background-color"]),$(this.originalElement).css("background-image","url("+this.data["background-image"]+")"),$(this.originalElement).find(".text_input_area").val(this.data.text).css({fontSize:this.data["font-size"],fontFamily:this.data["font-family"],color:this.data.color?this.data.color:"#000000",fontWeight:this.data["font-weight"]?this.data["font-weight"]:200}),$(this.originalElement).find("textarea").css("border-radius",this.data["border-radius"]+"%")},A3Maker.Component.LinkComponent=function(t,e){this.defaultsrc="images/img_link.png",this.name="";var i={left:10,UUID:"",wrapperId:"",no:0,name:"",top:10,width:60,height:60,type:"link",opacity:1,"border-radius":0,fixRatio:!1,"background-image":this.defaultsrc,position:"",linkType:"PageLink",linkTarget:"",text:"","font-family":"Open Sans","font-size":"30pt","font-weight":100,color:"#FF862D"};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,A3Maker.Component.Base.call(this,i)},A3Maker.Component.LinkComponent.prototype.refresh=function(t){""==this.data["background-image"]&&(this.data["background-image"]=this.defaultsrc),$(this.originalElement).css("opacity",this.data.opacity),$(this.originalElement).css("border-radius",this.data["border-radius"]+"%"),$(this.originalElement).attr("src",this.data["background-image"])},A3Maker.Component.OrderComponent=function(t,e){this.defaultsrc="images/img_order.png",this.name="";var i={UUID:"",wrapperId:"",no:0,name:"",left:10,top:10,width:60,height:60,type:"order",opacity:1,"border-radius":0,fixRatio:!1,"background-image":this.defaultsrc,menuGroupCode:"",menuGroupName:"",storeCode:"S1",menuCode:"",menuName:"",menuPrice:0,menuDes:"",menuUnit:"원",menuStock:0,menuDiscount:0};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,A3Maker.Component.Base.call(this,i)},A3Maker.Component.OrderComponent.prototype.refresh=function(t){""==this.data["background-image"]&&(this.data["background-image"]=this.defaultsrc),$(this.originalElement).css("opacity",this.data.opacity),$(this.originalElement).css("border-radius",this.data["border-radius"]+"%"),$(this.originalElement).attr("src",this.data["background-image"]),$(this.originalElement).attr("item_name",this.data.menuName),$(this.originalElement).attr("group_name",this.data.menuGroupName),$(this.originalElement).attr("group_code",this.data.menuGroupCode),$(this.originalElement).attr("item_price",this.data.menuPrice),$(this.originalElement).attr("item_code",this.data.menuCode),$(this.originalElement).attr("store_code",A3Maker.dummy.storeCode),this.enablePropertyWindow(!1),this.enablePropertyWindow(!0)},A3Maker.Component.OrderComponent.prototype.setProduct=function(t){this.setData(t),$(this.externalWrapperQueryStr+" .component-order").attr("menuName",this.menuName),$(this.externalWrapperQueryStr+" .component-order").attr("menuCode",this.menuCode),$(this.externalWrapperQueryStr+" .component-order").attr("menuPrice",this.menuPrice),$(this.externalWrapperQueryStr+" .component-order").attr("menuStock",this.menuStock),this.refresh()},A3Maker.Component.ListComponent=function(t,e){this.name="";var i={UUID:"",wrapperId:"",no:0,name:"",left:10,top:10,width:A3Maker.project.width-100,height:A3Maker.project.width-300,type:"list",fixRatio:!1,opacity:1,"background-color":"#ffffffff","background-image":"","overflow-x":"hidden","overflow-y":"auto","background-image":"",rowsTop:5};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,this.permitComponents=["listrow"],this.childs=[],A3Maker.Component.Base.call(this,i)},A3Maker.Component.ListComponent.prototype.refresh=function(t){$(this.originalElement).css("opacity",this.data.opacity),$(this.originalElement).css("background-color",this.data["background-color"]),$(this.originalElement).css("background-size","100% 100%"),$(this.originalElement).css("overflow-x","hidden"),$(this.originalElement).css("overflow-y","auto"),$(this.originalElement).css("background-image","url("+this.data["background-image"]+")")},A3Maker.Component.ListRowComponent=function(t,e){this.name="";var i={UUID:"",wrapperId:"",no:0,name:"",left:4,top:0,width:100,height:100,type:"listrow",opacity:1,fixRatio:!1,color:"#000000","background-color":"#ffffffff","background-image":"","overflow-x":"hidden","overflow-y":"auto"};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,this.permitComponents=["image","text","link","order"],this.childs=[],A3Maker.Component.Base.call(this,i),this.gripBottomLineStr=this.externalWrapperQueryStr+" .gripbottonline"},A3Maker.Component.ListRowComponent.prototype.refresh=function(t){$(this.originalElement).css("opacity",this.data.opacity),$(this.originalElement).css("background-color",this.data["background-color"]),$(this.originalElement).css("background-size","100% 100%"),$(this.originalElement).css("overflow-x","hidden"),$(this.originalElement).css("overflow-y","auto"),$(this.originalElement).css("background-image","url("+this.data["background-image"]+")")},A3Maker.Component.PopupComponent=function(t,e){this.name="";var i={UUID:"",wrapperId:"",no:0,name:"",left:10,top:10,type:"popup",opacity:1,fixRatio:!1,"background-color":"#FFFFFF","background-image":"","border-radius":0};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,this.permitComponents=["image","text","link","order"],this.childs=[],A3Maker.Component.Base.call(this,i)},A3Maker.Component.PopupComponent.prototype.refresh=function(t){$(this.originalElement).css("background-color",this.data["background-color"]),$(this.originalElement).css("background-size","100% 100%"),$(this.originalElement).css("overflow-x","hidden"),$(this.originalElement).css("overflow-y","auto"),$(this.originalElement).css("background-image","url("+this.data["background-image"]+")"),$(this.originalElement).css("opacity",this.data.opacity),$(this.originalElement).css("border-radius",this.data["border-radius"]+"%")},A3Maker.Component.PanseoComponent=function(t,e){this.name="";var i={UUID:"",wrapperId:"",no:0,name:"",type:"panseo",left:0,top:0,opacity:1,width:A3Maker.project.width,height:A3Maker.project.width,fixRatio:!1,"background-color":"rgba(255,255,255,0)","background-image":"",isDrawing:!1,isErasing:!1,strokeStyle:"#000000",fillStyle:"#FFFFFF",lineWidth:2,lineJoin:"round",lineCap:"round","border-radius":0,UUID:A3Maker.util.genUUID(),canvasID:A3Maker.util.generateRandomString(20)};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,A3Maker.Component.Base.call(this,i)},A3Maker.Component.PanseoComponent.prototype.settingCanvas=function(t){function e(t){t.stopPropagation(),1===t.buttons&&(k=!0,(p||c)&&(d=t.offsetX,m=t.offsetY),c&&(h.canvas.style.cursor="crosshair"),p&&(h.canvas.style.cursor="crosshair"))}function i(t){t.stopPropagation(),k=!1,c&&f&&(h.ctx.clearRect(f.x-f.radius,f.y-f.radius,2*f.radius,2*f.radius),f=null),h.canvas.style.cursor="default"}function o(t){t.stopPropagation(),A=!0,d=t.offsetX,m=t.offsetY}function a(t){t.stopPropagation(),A=!1}function n(t){t.stopPropagation(),k&&A&&p?r(t.offsetX,t.offsetY):k&&A&&c&&(s(t.offsetX,t.offsetY),h.ctx.clearRect(g-h.data.lineWidth,u-h.data.lineWidth,2*h.data.lineWidth,2*h.data.lineWidth),l(t.offsetX,t.offsetY),g=t.offsetX,u=t.offsetY)}function r(t,e){h.ctx.beginPath(),h.ctx.strokeStyle=h.data.strokeStyle,h.ctx.lineWidth=h.data.lineWidth,h.ctx.lineCap=h.data.lineCap,h.ctx.lineJoin=h.data.lineJoin,h.ctx.moveTo(d,m),h.ctx.lineTo(t,e),h.ctx.stroke(),d=t,m=e}function s(t,e){h.ctx.globalCompositeOperation="destination-out",h.ctx.beginPath(),h.ctx.lineCap=h.data.lineCap,h.ctx.lineJoin=h.data.lineJoin,h.ctx.arc(t,e,10,0,2*Math.PI),h.ctx.fillStyle="rgba(0, 0, 0, 1)",h.ctx.fill(),h.ctx.globalCompositeOperation="source-over"}function l(t,e){f={x:t,y:e,radius:h.data.lineWidth},h.ctx.beginPath(),h.ctx.arc(t,e,h.data.lineWidth,0,2*Math.PI),h.ctx.fillStyle="yellow",h.ctx.fill()}console.log("settingCanvas parameter : "+t);var h=null;let p=!1,c=!1,d=null,m=null,g=0,u=0,f=null,A=!1,k=!1;if((t==A3Maker.config.CANVAS_MODE.STOP_DRAW||t==A3Maker.config.CANVAS_MODE.STOP_ERASE_DRAW)&&this.canvasEvent&&this.canvas){for(eventName in this.canvasEvent)this.canvas.removeEventListener(eventName,this.canvasEvent[eventName]);t==A3Maker.config.CANVAS_MODE.STOP_DRAW&&(p=!1),t==A3Maker.config.CANVAS_MODE.STOP_ERASE_DRAW&&(c=!1),this.canvas=null,this.ctx=null,this.canvasEvent=null,delete this.canvas,delete this.ctx,delete this.canvasEvent,this.showBorderTool()}if(t==A3Maker.config.CANVAS_MODE.START_DRAW&&(this.hideBorderTool(),this.hideGripTool(),this.canvas=document.getElementById(this.data.canvasID),this.ctx=this.canvas.getContext("2d"),h=this,d=this.canvas.width/2,m=this.canvas.height/2,p=!p,c=!1,this.canvas.addEventListener("mousedown",e),this.canvas.addEventListener("mousemove",n,{passive:!0}),this.canvas.addEventListener("mouseup",i),this.canvas.addEventListener("mouseenter",o),this.canvas.addEventListener("mouseleave",a),this.canvasEvent={mousedown:e,mousemove:n,mouseup:i,mouseenter:o,mouseleave:a}),t==A3Maker.config.CANVAS_MODE.START_ERASE_DRAW&&(this.hideBorderTool(),this.hideGripTool(),c=!c,p=!1,this.canvas=document.getElementById(this.data.canvasID),this.ctx=this.canvas.getContext("2d"),h=this,d=this.canvas.width/2,m=this.canvas.height/2,this.canvas.addEventListener("mousedown",e),this.canvas.addEventListener("mousemove",n,{passive:!0}),this.canvas.addEventListener("mouseup",i),this.canvas.addEventListener("mouseenter",o),this.canvas.addEventListener("mouseleave",a),this.canvasEvent={mousedown:e,mousemove:n,mouseup:i,mouseenter:o,mouseleave:a}),A3Maker.config.CANVAS_MODE.CLIP_DRAW,t==A3Maker.config.CANVAS_MODE.CLEAR_DRAW)if(this.context&&this.ctx)this.ctx.clearRect(0,0,y.width,y.height);else{var y=document.getElementById(this.data.canvasID);y.getContext("2d").clearRect(0,0,y.width,y.height)}A3Maker.config.CANVAS_MODE.DOWN_DRAW},A3Maker.Component.PanseoComponent.prototype.refresh=function(t){$(this.originalElement).css("opacity",this.data.opacity),$(this.originalElement).css("border-radius",this.data["border-radius"]+"%"),$(this.originalElement).css("background-color",this.data["background-color"]),$(this.originalElement).css("background-size","100% 100%"),$(this.originalElement).css("overflow-x","hidden"),$(this.originalElement).css("overflow-y","auto"),$(this.originalElement).css("background-color",this.data["background-color"]),$(this.originalElement).css("background-image","url("+this.data["background-image"]+")")},A3Maker.Component.CameraComponent=function(t,e){this.defaultSrc="images/img_camera.png",this.name="";var i={UUID:"",wrapperId:"",no:0,name:"",type:"camera",left:30,top:30,opacity:1,width:400,height:300,fixRatio:!1,"background-color":"#333333","background-image":this.defaultsrc,"border-radius":0,UUID:A3Maker.util.genUUID(),defaultResolutions:["VGA","QVGA","CUSTOME"],resolutionType:"CUSTOM",poster:this.defaultSrc,useAudio:!1,micVolume:5,useVideo:!0,facingMode:A3Maker.config.CAMERA.FACING_MODE.FRONT,videoID:A3Maker.util.generateRandomString(20),videoRecorder:null,videoStatus:{isPlaying:!1,isPausing:!1,isRecording:!1,isPreviewing:!1}};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,A3Maker.Component.Base.call(this,i)},A3Maker.Component.CameraComponent.prototype.refresh=function(t){},A3Maker.Component.ScriptComponent=function(t,e){this.defaultsrc="images/script.png",this.name="";var i={UUID:"",wrapperId:"",no:0,name:"",left:10,top:10,type:"script",width:75,height:69,fixRatio:!1,"background-image":this.defaultsrc,script:""};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),this.parent=t,A3Maker.Component.Base.call(this,i)},A3Maker.Component.TableComponent=function(t,e){this.name="";var i={UUID:"",wrapperId:"",no:0,name:"",left:50,top:50,rowCnt:4,colCnt:4,width:800,height:160,fixRatio:!1,cellspacing:0,cellpadding:0,type:"table",border:1,color:"#000000","background-color":"#ffffff","border-color":"#555555","border-style":"solid",opacity:.6,"font-size":"13px","font-family":"Malgum Gothic","backround-image":"",opacity:1};this.componentSettings={selectable:!0,draggablee:!0,resizeable:!1},e&&$.extend(i,e),i.height=40*i.rowCnt,this.parent=t,this.childs=[],A3Maker.Component.Base.call(this,i)},A3Maker.Component.TableComponent.prototype.refresh=function(t){$(this.originalElement).attr("opacity",this.data.opacity),$(this.originalElement).css("background-color",this.data["background-color"]),$(this.originalElement).css("background-size","100% 100%"),$(this.originalElement).css("overflow-x","hidden"),$(this.originalElement).css("overflow-y","auto"),$(this.originalElement).css("background-image","url("+this.data["background-image"]+")")},A3Maker.class.extend(A3Maker.Component.ImageComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.TextComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.LinkComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.OrderComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.PopupComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.ListComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.ListRowComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.ScriptComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.TableComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.PanseoComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype),A3Maker.class.extend(A3Maker.Component.CameraComponent.prototype,new A3Maker.Component.Base,A3Maker.class.subClassAddfuncs,A3Maker.Component.Base.prototype);