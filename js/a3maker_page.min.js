A3Maker=A3Maker||{},A3Maker.class={subClassAddfuncs:{get:function(e){return this.hasOwnProperty(e)?this[e]:fasle},get:function(e,t){return!!this.hasOwnProperty(e)&&(this[e]=t,!0)}},extend:function(e,t,o,a){if(null!=a&&(e.parentClass=a),null!=t)for(var r in t)e[r]=t[r];if(null!=o)for(var r in o)e[r]=o[r]}},A3Maker.Page=function(e){this.data=e,this.data&&void 0!==this.data.childs&&delete this.data.childs,this.childs=new Array,this.isComponentAction=!1,this.selectedComponent=null,this.type=this.data.type="page",this.selectedStatus=!0,this.preparePageSettings(),this.selectionRect="",A3Maker.project.componentMap[this.data.id]=this},A3Maker.Page.prototype.preparePageSettings=function(){this.$pageHolderSelector=$('<div style ="background-size:100% 100%;left:0px; top:0px;width:100%;height:100%" id ='+this.data.UUID+' class ="editor-page page '+this.data.name+'"><div class="cross_grid_line" style="display:none;width:100%;height:100%"></div></div>"'),this.data["background-color"]&&this.$pageHolderSelector.css("background-color",this.data["background-color"]),void 0!==this.data["background-image"]&&""!=this.data["background-image"]&&this.$pageHolderSelector.css("background-image","url("+this.data["background-image"]+")"),this.$pageHolderSelector.css({position:"absolute",overflow:"visible"}),this.$pageHolderSelector.addClass("page-border"),this.$pageHolderSelector.addClass(this.data.name),this.$pageHolderSelector.appendTo($(A3Maker.holder)),this.pageHolderSelectorStr="#"+this.data.id,A3Maker.setSelectedPage(this)},A3Maker.Page.prototype.findComponents=function(e){var t=[];return $.each(this.childs,function(o,a){a.data.type==e&&t.push(a)}),t},A3Maker.Page.prototype.extract=function(e){var t=this;$.each(e,function(e,o){t.setProperty(e,o)})},A3Maker.Page.prototype.getProperty=function(e){return!!this.hasOwnProperty(e)&&this.data[e]},A3Maker.Page.prototype.refresh=function(){this.$pageHolderSelector.css("background-color",this.data["background-color"]),console.log("background-color"),console.log(this.data["background-color"]),this.$pageHolderSelector.css("background-size","100% 100%"),this.$pageHolderSelector.css("overflow","visible"),this.$pageHolderSelector.css("opacity",this.data.opacity),this.$pageHolderSelector.css("background-image","url("+this.data["background-image"]+")")},A3Maker.Page.prototype.setProperty=function(e,t){this.data[e]=t},A3Maker.Page.prototype.setData=function(e){Object.keys(e).forEach(t=>this.data[t]=e[t]),this.refresh()},A3Maker.Page.prototype.show=function(){this.$pageHolderSelector.show()},A3Maker.Page.prototype.hide=function(){this.$pageHolderSelector.hide()},A3Maker.Page.prototype.destroy=function(){this.$pageHolderSelector.remove()},A3Maker.Page.prototype.setPageDisplayPos=function(e,t){console.log(e+" : "+t),this.$pageHolderSelector.css({position:"absolute",display:"block",left:e+"px",top:t+"px"})},A3Maker.Page.prototype.changeAllComponentSelectStatusRecursive=function(e,t){console.log("recursive ");var o=this;e.childs&&e.childs.length>0&&$.each(e.childs,function(e,a){"list"==a.data.type||"listrow"==a.data.type||"popup"==a.data.type?o.changeAllComponentSelectStatusRecursive(a,t):t?(a.showBorderTool(),a.showGripTool(),a.selectStatus=!0):(a.hideBorderTool(),a.hideGripTool(),a.selectStatus=!1)})},A3Maker.Page.prototype.changeAllComponentSelectStatus=function(e){var t=this;this.childs.length>0&&$.each(this.childs,function(o,a){"list"==a.data.type?(t.EnableComponentBorderAndGrip(a,e),$.each(a.childs,function(o,a){$.each(a.child,function(o,a){t.EnableComponentBorderAndGrip(a,e)}),t.EnableComponentBorderAndGrip(a,e)})):"popup"==a.data.type?(t.EnableComponentBorderAndGrip(a,e),$.each(a.childs,function(o,a){"list"==a.data.type?$.each(a.childs,function(o,a){$.each(a.childs,function(o,a){t.EnableComponentBorderAndGrip(a,e)})}):t.EnableComponentBorderAndGrip(a,e)})):t.EnableComponentBorderAndGrip(a,e)})},A3Maker.Page.prototype.EnableComponentBorderAndGrip=function(e,t){t?(e.showBorderTool(),e.showGripTool(),e.selectStatus=!0):(e.hideBorderTool(),e.hideGripTool(),e.selectStatus=!1)},A3Maker.Page.prototype.isIncludePosition=function(e,t){for(var o=!1,a=0;a<this.childs.length;a++){var r=this.childs[a];e>=r.data.left&&t>=r.data.top&&e<=r.data.left+r.data.width&&t<=r.data.top+r.data.height&&(o=!0)}return o},A3Maker.Page.prototype.clearAll=function(){if(this.childs.length>0)for(var e=0;e<this.childs.length;e++)this.childs[e].selectStatus=!1,this.childs[e].detach();A3Maker.setSelectedComponent(null),this.childs.length=0,A3Maker.controller.setComCount("#page1",this.childs.length)},A3Maker.Page.prototype.setSelectedComponent=function(e){this.selectedComponent=e},A3Maker.Page.prototype.addComponent=function(e){this.childs.push(e),this.curChildInx++,A3Maker.controller.setComCount("#page1",this.childs.length)},A3Maker.Page.prototype.addComponentToTree=function(e,t=!1){var o=A3Maker.controller.$tree.tree("getNodeById",this.data.UUID);if(t){var a=this.childs.findIndex(e=>"panseo"==e.data.type),r=this.childs[a],n=A3Maker.controller.$tree.tree("getNodeById",r.data.UUID);A3Maker.controller.$tree.tree("addNodeBefore",{label:e.data.name,id:e.data.UUID,type:e.data.type,data:e},n)}else A3Maker.controller.$tree.tree("appendNode",{label:e.data.name,id:e.data.UUID,type:e.data.type,data:e},o)},A3Maker.Page.prototype.removeComponent=function(e){var t=-1;$.each(this.childs,function(o,a){a.data.UUID!=e.data.UUID||(t=o)}),-1!=t&&this.childs.splice(t,1),this.removeCompoentToTree(e),e.selectStatus=!1,e.detach()},A3Maker.Page.prototype.removeCompoentToTree=function(e){var t=A3Maker.controller.$tree.tree("getNodeById",e.data.UUID);A3Maker.controller.$tree.tree("removeNode",t)},A3Maker.Page.prototype.adjustComponentSize=function(e){for(var t=0;t<this.childs.length;t++){var o=this.childs[t],a=o.data.left,r=o.data.top,n=o.data.width,i=o.data.height,s=parseInt(a*(e/100))-o.cornerActionTriggerRadius,d=parseInt(r*(e/100))-o.cornerActionTriggerRadius,l=parseInt(n*(e/100)),c=parseInt(i*(e/100));$(o.externalWrapperQueryStr).css("left",s+"px"),$(o.externalWrapperQueryStr).css("top",d+"px"),$(o.originalElement).css("width",l+"px"),$(o.originalElement).css("height",c+"px"),o.adjustWrapper(),o.adjustResizingBorder()}},A3Maker.Page.prototype.createComponent=function(e,t,o,a){A3Maker.contextMenu.close();t=void 0===t||t,o=void 0===o||o;var r=this.childs.findIndex(e=>"panseo"==e.data.type);if("panseo"!=e||-1==r){var n=-1!=r,i=A3Maker.Component.build(this,e,a);return 1==t&&this.addComponent(i),o&&this.addComponentToTree(i,n),A3Maker.controller.setComCount("#page1",this.childs.length),i}alert("판서 컴포넌트는 페이지별로 1개의 판서만 생성할 수 있습니다")},A3Maker.Page.prototype.createComponentNo=function(e){var t=0,o=$.map(this.childs,function(t){if(t.data.type==e)return t.data.no});return Array.isArray(o)?(0==o.length?t=1:(o.sort(function(e,t){return e<t?-1:e>t?1:0}),t=o[o.length-1]+1),t):1},A3Maker.Page.prototype.genComponentNo=function(e){var t=0,o=$.map(this.childs,function(t){if(t.data.type==e)return t});if(Array.isArray(o))return t=0==o.length?1:o[o.length-1].no,t},A3Maker.Page.prototype.genComponentNo=function(e){var t=0,o=$.map(this.childs,function(t){if(t.data.type==e)return t});if(Array.isArray(o))return t=0==o.length?1:o[o.length-1].no,t},A3Maker.Page.prototype.hasSameNamedComponent=function(e){var t=this.childs.findIndex(t=>t.data.name.trim()==e),o=-1!=t;return o};